<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Tor Onion Support – README</title>
<style>
  :root {
    --bg: #0f1120;
    --card: #16182b;
    --muted: #9aa4b2;
    --text: #e5e9f0;
    --accent: #7dd3fc;
    --warning: #fbbf24;
    --code: #0b0e1a;
    --border: #232646;
  }
  * { box-sizing: border-box; }
  html, body { margin: 0; padding: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji"; background: linear-gradient(180deg, #0e101d 0%, #0b0d18 100%); color: var(--text); }
  a { color: var(--accent); text-decoration: none; }
  a:hover { text-decoration: underline; }
  .container { max-width: 920px; margin: 40px auto; padding: 0 20px; }
  .hero {
    background: radial-gradient(1200px 600px at 100% -10%, rgba(125,211,252,0.08), transparent 60%),
                radial-gradient(1000px 500px at -10% 0%, rgba(139,92,246,0.08), transparent 60%),
                var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 28px 28px 22px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.35);
  }
  .hero h1 { margin: 0 0 6px; font-size: 28px; letter-spacing: 0.3px; }
  .hero p { margin: 0; color: var(--muted); }
  .badge { display: inline-block; padding: 6px 10px; font-size: 12px; border: 1px solid var(--border); border-radius: 999px; color: var(--muted); margin-right: 8px; background: rgba(255,255,255,0.03) }
  .grid { display: grid; grid-template-columns: 1fr; gap: 18px; margin-top: 26px; }
  @media (min-width: 880px){ .grid { grid-template-columns: 1fr 1fr; } }
  .card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 18px 18px 16px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.25);
  }
  .card h2 { margin: 0 0 10px; font-size: 18px; }
  .card h3 { margin: 16px 0 8px; font-size: 15px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.08em; }
  .list { margin: 0; padding-left: 18px; }
  .small { color: var(--muted); font-size: 14px; }
  .code, pre, code {
    background: var(--code);
    color: #e6f3ff;
    border: 1px solid #1c2038;
    border-radius: 10px;
    padding: 12px;
    overflow: auto;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    font-size: 13px;
  }
  .callout {
    border-left: 4px solid var(--warning);
    background: rgba(251,191,36,0.07);
    padding: 12px 14px;
    border-radius: 10px;
  }
  .footer { text-align: center; color: var(--muted); font-size: 13px; margin: 26px 0 10px; }
  .chips { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
  .chip { background: rgba(255,255,255,0.04); border: 1px solid var(--border); color: var(--muted); padding: 6px 10px; border-radius: 999px; font-size: 12px; }
  .kbd { background:#11142a;border:1px solid #262a52;border-bottom-width:2px;padding:2px 6px;border-radius:6px;font-family:ui-monospace,monospace;font-size:12px }
</style>
</head>
<body>
  <div class="container">
    <section class="hero">
      <div class="chips">
        <span class="badge">Version 1.0.0</span>
        <span class="badge">Requires WP 6.0+</span>
        <span class="badge">PHP 7.4+</span>
        <span class="badge">Multisite-ready</span>
      </div>
      <h1>Tor Onion Support</h1>
      <p>Clean, conservative, and WordPress.org‑compliant support for serving WordPress sites via Tor hidden services (.onion).</p>
    </section>

    <div class="grid">
      <article class="card">
        <h2>Description</h2>
        <p>Rewrites runtime URLs for .onion requests, avoids onion→clearnet canonical leaks, optionally sends <code>Onion-Location</code>, and adds privacy‑focused hardening (CSP, COEP, oEmbed disable) for onion visitors.</p>
        <ul class="list">
          <li>No core hacks, filters/actions only</li>
          <li>Per‑site mapping + Network Defaults (Multisite)</li>
          <li>Optional WP‑CLI tools &amp; localization‑ready</li>
        </ul>

        <h3>⚠ Important Warning</h3>
        <div class="callout">
          <strong>BEWARE:</strong> If you aim to make your site available <em>only</em> on the darknet to preserve server/host anonymity, this plugin is <strong>NOT</strong> for you. It does not anonymize infrastructure; it only adapts WordPress behavior for onion visitors.
        </div>
      </article>

      <article class="card">
        <h2>Features</h2>
        <ul class="list">
          <li>Detects .onion and rewrites URLs at runtime (DB options untouched)</li>
          <li>Onion‑Location header from clearnet (optional)</li>
          <li>Hardening for onion visitors (CSP, COEP, X‑Frame‑Options, no oEmbed)</li>
          <li>Opt‑in Tor exit‑list verification (cached)</li>
          <li>WP‑CLI commands + developer filters</li>
        </ul>
        <div class="chips">
          <span class="chip">CSP</span>
          <span class="chip">Onion‑Location</span>
          <span class="chip">WP‑CLI</span>
          <span class="chip">Multisite</span>
        </div>
      </article>

      <article class="card">
        <h2>Installation</h2>
        <ol class="list">
          <li>Upload <code>tor-onion-support</code> to <code>/wp-content/plugins/</code>.</li>
          <li>Activate via <em>Plugins</em>.</li>
          <li>Settings → <strong>Tor / .onion</strong>: set your <code>example.onion</code> host and hardening options.</li>
          <li>Multisite: Network Admin → Tor / .onion → Mapping &amp; Network Defaults.</li>
        </ol>
        <p class="small"><strong>Optional exit‑list check:</strong> <span class="kbd">define('TOS_VERIFY_TOR_EXIT', true);</span> or add filter <span class="kbd">tor_onion_verify_exit_list</span>. Cached for 24h.</p>
      </article>

      <article class="card">
        <h2>Settings (Quick Guide)</h2>
        <ul class="list">
          <li><strong>.onion domain</strong> — host only (e.g., <code>abcd1234xyz.onion</code>).</li>
          <li><strong>Onion‑Location</strong> — advertise onion mirror from clearnet.</li>
          <li><strong>Onion hardening</strong> — stricter headers for onion visitors.</li>
          <li><strong>Disable oEmbed</strong> — avoid 3rd‑party embeds on onion.</li>
          <li><strong>CSP mode</strong> — <em>Strict</em>, <em>Relaxed</em>, <em>Off</em>, <em>Custom</em>.</li>
        </ul>
        <p class="small"><em>Tip:</em> Start with <strong>Strict</strong>. If a theme/plugin breaks, try <strong>Relaxed</strong>. Use <strong>Custom</strong> only if you know CSP.</p>
      </article>

      <article class="card">
        <h2>Custom CSP – Examples</h2>
<pre class="code">default-src 'self';
script-src 'self';
style-src 'self' 'unsafe-inline';
img-src 'self' data:;
font-src 'self' data:;
connect-src 'self';
frame-src 'self';
frame-ancestors 'self';
base-uri 'self';
form-action 'self';</pre>

<pre class="code">default-src 'self';
script-src 'self' 'unsafe-inline';
style-src 'self' 'unsafe-inline';
img-src 'self' data:;
font-src 'self' data:;
connect-src 'self';
frame-src 'self';</pre>

<pre class="code">img-src 'self' https://cdn.example.com data:;
font-src 'self' https://cdn.example.com data:;</pre>
        <p class="small">The Custom CSP field is used only when mode = <strong>Custom</strong>. The plugin sends exactly what you enter.</p>
      </article>

      <article class="card">
        <h2>WP‑CLI</h2>
<pre class="code">wp tor-onion list
wp tor-onion map &lt;blog_id|0&gt; example.onion
wp tor-onion set --hardening=on --oembed=off --csp=strict</pre>
        <h3>Developer Filters</h3>
<pre class="code">add_filter('tor_onion_is_tor_request', function($is_tor, $server){
  return $is_tor;
}, 10, 2);

add_filter('tor_onion_verify_exit_list', '__return_true');</pre>
      </article>
    </div>

    <p class="footer">© Tor Onion Support — GPLv2 or later. Textdomain: <code>tor-onion-support</code>.</p>
  </div>
</body>
</html>
